<div>
  <div>
    <h1>
      Available Units
    </h1>
  </div>
</div>

<hr>

<div>
  <div>
    <h2>
      Add a new unit
    </h2>

    <% if current_alum != nil %>
    <form action="/insert_unit" method="post">
      <div>
        <label for="city_box">
          City
        </label>

        <input type="text" id="city_box" name="query_city">
      </div>

      <div>
        <label for="address_box">
          Address
        </label>

        <input type="text" id="address_box" name="query_address">
      </div>

      <div>
        <label for="unit_image_box">
          Unit image
        </label>

        <input type="text" id="unit_image_box" name="query_unit_image">
      </div>

      <div>
        <label for="unit_bio_box">
          Unit bio
        </label>

        <textarea id="unit_bio_box" name="query_unit_bio" rows="3"></textarea>
      </div>

      <button>
        Create unit
      </button>
    </form>
    <% else %>
      <p>You must <a href="/alums/sign_in">sign in</a> to add a unit.</p>
    <% end %>
  </div>
</div>

<hr>

<div>
  <div>
    <h2>
      Filter by City
    </h2>

    <form method="get" action="/units">
      <div>
        <label for="filter_city">
          Select a city:
        </label>
        <select id="filter_city" name="city">
          <option value="">All Cities</option>
          <% @list_of_units.map(&:city).uniq.each do |city| %>
            <option value="<%= city %>" <%= "selected" if params[:city] == city %>><%= city %></option>
          <% end %>
        </select>
        <button type="submit">Filter</button>
        <a href="/units" class="button" style="margin-left: 10px;">Reset Filter</a> <!-- Reset button -->
      </div>
    </form>
  </div>
</div>

<hr>
<div>
  <div>
    <table border="1">
      <tr>
        <th>
          Image
        </th>

        <th>
          City
        </th>

        <th>
          Address
        </th>

        <th>
          Bio
        </th>
        <th>
          When Posted
        </th>

        <th>
        </th>
      </tr>

      <% @list_of_units.each do |a_unit| %>
      <tr>
        <td>
          <% if a_unit.unit_image.present? %>
            <%= image_tag(a_unit.unit_image, alt: "Unit Image", style: "width: 150px; height: auto; object-fit: contain;") %>
          <% else %>
            No Image Available
          <% end %>
        </td>
        <td>
          <%= a_unit.city %>
        </td>

        <td>
          <%= a_unit.address %>
        </td>

        <td>
          <%= a_unit.unit_bio %>
        </td>

        <td>
          <%= time_ago_in_words(a_unit.created_at) %> ago
        </td>

        <td>
          <a href="/units/<%= a_unit.id %>">
            Show details
          </a>
        </td>
      </tr>
      <% end %>
    </table>
  </div>
</div>

<hr>
